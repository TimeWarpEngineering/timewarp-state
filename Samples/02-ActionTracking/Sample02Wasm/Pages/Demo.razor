@page "/demo"
@using Sample02Wasm.Features.Demo
@using TimeWarp.Features.ActionTracking
@inherits TimeWarpStateComponent

<PageTitle>Action Tracking Demo</PageTitle>

<h1>Action Tracking Demo</h1>

<div class="mb-3">
    <h3>Action Status</h3>
    <p><strong>Any Active Actions:</strong> @ActionTrackingState.IsActive</p>
    <p><strong>Quick Action Running:</strong> @IsQuickActionRunning</p>
    <p><strong>Long Action Running:</strong> @IsLongActionRunning</p>
</div>

<div class="mb-3">
    <button class="btn btn-primary me-2" @onclick="StartQuickAction">
        Start 2-Second Action
    </button>
    <button class="btn btn-primary" @onclick="StartLongAction">
        Start 5-Second Action
    </button>
</div>

<div class="mb-3">
    <h3>Active Actions</h3>
    @if (ActionTrackingState.IsActive)
    {
        foreach (var action in ActionTrackingState.ActiveActions)
        {
            <div class="alert alert-info">
                Running: @action.GetType().FullName
            </div>
        }
    }
    else
    {
        <p>No active actions</p>
    }
</div>

@code {
    DemoState DemoState => GetState<DemoState>();
    ActionTrackingState ActionTrackingState => GetState<ActionTrackingState>();

    bool IsQuickActionRunning => ActionTrackingState.IsAnyActive
    (
        [typeof(DemoState.QuickActionSet.Action)]
    );

    bool IsLongActionRunning => ActionTrackingState.IsAnyActive
    (
        [typeof(DemoState.LongActionSet.Action)]
    );

    private async Task StartQuickAction() => 
        await DemoState.Quick();

    private async Task StartLongAction() => 
        await DemoState.Long();
}
